In the Cipher Block Chaining (CBC) mode, the input to the encryption algorithm is the XOR of the current plaintext block and the preceding ciphertext block; the same key is used for each block. In effect, they are chained together with the processing of the sequence of plaintext blocks. An initialization vector (IV) is XORed with the first plaintext block to produce the first ciphertext block. The CBC mode requires that the last block be padded to full b bits if it is a partial block.
![[qkuletsa.jpg]]
For decryption, each cipher block is passed through the decryption algorithm. The result is XORed with the preceding ciphertext block to produce the plaintext block. On decryption, the IV is XORed with the current output of the decryption algorithm to recover the first block of plaintext. The IV is a data block that is the same size as the cipher block. The IV must be known to both the sender and receiver but be unpredictable by a third party.

![[oqar3vum.jpg]]
To get started, open a new browser window and visit the padding-oracle.com webserver on port 5001
`padding-oracle.com:5001

Click on the Register option and move to the next step.
# Start BurpSuite

Burp Suite is a tool that comes in helpful when attacking websites and web applications. Burp Suite acts as a proxy, controlling the flow of traffic between an attacker's browser and the target.
## Configure Firefox
Click on 'Manual proxy configuration'. Afterward, set the IP address to `127.0.0.1` and the Burp Proxy listener port to `8080`. To finish, click OK to close all of the options dialogs.
# Create a new user

Return to the web application and enter the following credentials to Register.
Username: `student`
Password: `computer`

Go back to Burpsuite and ensure that the Interception is on before submitting. Forward the first request sent to the webserver by clicking on the Forward button. This POST request will contain the values typed in the input fields.
# Retrieve Authentication Cookie

The interesting request is the next one, a GET request containing the value of the authentication cookie.
![[Pasted image 20250814192457.png]]

Right-click on the request and choose "Send to Repeater" from the context menu. Repeater is a tool for manually manipulating and reissuing HTTP requests and analyzing the application's responses. Now, visit the Repeater tab and click the Send button.
# Decrypt The Value Of Auth Key

Copy the value of the _auth_ cookie and open a new terminal.

A tool called **PadBuster** is incredibly effective at exploiting the Padding Oracle Vulnerability. The block size of the cipher is set to **8**, and the sample is **base64** encoded.
`padbuster http://padding-oracle.com:5001/login.php 'auth' 8 --cookies auth='auth' encoding 0

Replace every placeholder named 'auth' with the cookie value you just copied (don't leave the literal word 'auth' in the command):
Type 2 when it asks for an ID that matches the error condition.

Basically this tool is "decoding" by doing Decode base64 -> unpad the decodes `hex`  and convert that hex into ascii!
