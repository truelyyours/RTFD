# Syslog

All actions, requests, connections, applications, and processes generate logs that help define normal user behavior and identify unusual or malicious activities. Syslog standardizes the generation and handling of log messages. When used over a network, Syslog employs a client-server architecture to collect logs from various devices. It is available for all major operating systems.

[Rsyslog](https://github.com/rsyslog/rsyslog) is an open-source implementation of the Syslog protocol for UNIX-based systems, configurable as either a client or server. It is known for its ease of installation and configuration and offers advanced features such as content-based filtering.
Rsyslog logs are usually stored in `/var/log/syslog`.

To view them, open a terminal and run:
`sudo cat /var/log/syslog

The output shows log messages containing the day when they occurred, the time, the device name, the application that generated the logs, and the message.

The logs indicate that a cron job is running continuously, executing a file named _backdoor.sh_. This script establishes a reverse shell connection, opening a port and providing a bash session to anyone who connects. This suggests that an attacker has gained access to the system and is using cron jobs for persistent access. To remove this threat, delete the _backdoor.sh_ file:
`sudo rm /backdoor.sh

Which transport protocol is commonly used by syslog for sending log messages? **UDP**
# SIEM

Security Information and Event Management, known as SIEM, is a software solution that aggregates and analyzes activity from many different resources across an entire IT infrastructure. SIEM collects security data from network devices, servers, domain controllers and allows organizations to normalize, aggregate and analyze data to detect threats. It stores, normalizes, aggregates, and applies analytics to that data to detect threats, discover trends, and allow organizations to investigate any alerts that occur.

Splunk is a widely used platform for monitoring, analyzing and visualizing data. To access its web interface, open a web browser and type the following IP address and port number in the URL:
`http://172.20.1.12:8000

Type `admin` for the username and `P@ssw0rd` for the password.
# Splunk

After authenticating, click on _Settings_ > _Add Data_.

To analyze an Apache log file for suspicious login attempts, click on _Add Data_, then select _Upload_.

Click on Select File, navigate to _/home/ubuntu-user_ in the pop-up window, select _access.log_, and import it. Click on _Next_.

On the _Set Source Type_ page, assign the data type _access_combined_ to ensure proper formatting during indexing.

Click _Next_, then _Review_, and finally _Submit_. When you see _"File has been uploaded successfully,"_ click Start Searching to analyze the logs.

SIEM platforms aggregate logs to assist system administrators and security professionals. Splunk, for instance, groups similar requests and shows their overall traffic volume. To view patterns in the file, click on Pattern.

If most requests are directed at _/wp-login.php_ and the user agent is WPScan, a WordPress security scanner, this indicates a possible brute-force attack.

To view all requests by WPScan, use the following search query:
`| stats count by useragent | sort - count

Patterns in requests are more than common. However, if they are directed at sensitive resources or login pages, they should be looked into, especially when the user agent is a tool known for enumeration and exploitation.


How many events were generated by the WPScan user-agent? `13435`
![[Pasted image 20250815160415.png]]

